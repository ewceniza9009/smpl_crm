@{
    ViewBag.Title = "CUSTOMER LIST";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="page-header">
    <h2>Customer Management</h2>
    <div class="actions">
        <button type="button" class="btn btn-primary" onclick="CmdAdd_onclick()">
            <span class="glyphicon glyphicon-plus"></span> Add Customer
        </button>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table id="MstCustomerListDataTable" class="table table-hover" style="width:100%;">
                <thead>
                    <tr>
                        <th>Detail</th>
                        <th>Delete</th>
                        <th>Name</th>
                        <th>Address</th>
                        <th>Contact Person</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<script type="text/javascript" src="~/Scripts/jquery-2.0.3.js"></script>
<script type="text/javascript" src="~/Scripts/jquery.dataTables.js"></script>
<script type="text/javascript" src="~/Scripts/bootstrap-dataTables-paging.js"></script>
<script type="text/javascript" src="~/Scripts/toastr.js"></script>

<script>
    $(document).ready(function () {
        $('#MstCustomerListDataTable').dataTable({
            "bServerSide": true,
            "bProcessing": true,
            "sAjaxSource": "@Url.Action("MstCustomerList", "Home")",
            "aoColumns": [
                {
                    "mData": "Id", "bSearchable": false,
                    "bSortable": false,
                    "sWidth": "80px", // Adjusted width
                    "mRender": function (data) {
                        return '<button type="button" class="btn btn-sm btn-default" onclick="CmdDetail_onclick(' + data + ')"><i class="glyphicon glyphicon-list-alt"></i> Detail</button>';
                    }
                },
                {
                    "mData": "Id", "bSearchable": false,
                    "bSortable": false,
                    "sWidth": "80px", // Adjusted width
                    "mRender": function (data) {
                        return '<button type="button" class="btn btn-sm btn-danger" onclick="CmdDelete_onclick(' + data + ')"><i class="glyphicon glyphicon-trash"></i> Delete</button>';
                    }
                },
                { "mDataProp": "Name" },
                { "mDataProp": "Address" },
                { "mDataProp": "ContactPerson" }
            ]
        });
    });

    function CmdDelete_onclick(id) {
        if (confirm("Do you want to delete this customer: " + id)) {
            var data = { 'id': id };
            $.post('@Url.Action("MstCustomerListDelete", "Home")', data,
                function (retdata) {
                    if (retdata == true) {
                        toastr.success("Record deleted successfully.");
                        // Full page reload as per original logic
                        location.reload();
                    }
                    else {
                        toastr.error("Record delete failed.");
                    }
                });
        }
    }

    function CmdDetail_onclick(id) {
        if (id > 0) {
            window.location.href = '@Url.Action("MstCustomerDetailView", "Home")?Id=' + id;
        }
    }

    function CmdAdd_onclick() {
        window.location.href = '@Url.Action("MstCustomerDetailView", "Home")';
    }
</script>