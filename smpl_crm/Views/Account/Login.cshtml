@model smpl_crm.Controllers.LoginModel

@{
    ViewBag.Title = "Login";
}

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="@Url.Content("~/logo/streetsmartLogo.ico")" type="image/x-icon" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <link href="@Url.Content("~/Content/bootstrap.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/dataTable/css/jquery.datatables.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/bootstrap-datatables.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/datepicker.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/css/select2.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/select2-bootstrap.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/toastr.css")" rel="stylesheet" />
    <style>
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
        }

        main {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            max-width: 400px;
            width: 100%;
            padding: 5rem;
            border-color: rgba(28,108,116,0.70);
            box-shadow: 0.6rem 0.6rem 0.6rem rgba(63,151,148,0.70);
            background: linear-gradient(20deg, rgba(28,108,116,0.80), rgba(63,151,148,0.80)), url('/Content/images/Jumbotron.png') no-repeat center center;
            background-size: cover, cover;
        }

        .form-label {
            font-weight: 600;
        }

        .btn-primary {
            background-color: #3F9794;
            border-color: rgba(28,108,116,0.70);
        }

            .btn-primary:hover {
                background-color: #6CC1BE;
                border-color: #6CC1BE;
            }

        .has-feedback {
            position: relative; /* MUST for icon to stay inside input */
        }

        .has-error .form-control {
            border-color: #dc3545;
            border-width: 1.5px;
        }

        .has-success .form-control {
            border-color: #28a745;
            border-width: 1.5px;
        }

        .has-feedback .form-control-feedback {
            position: absolute; /* absolutely inside form-group */
            right: 30px; /* inside input */
            top: 62%;
            transform: translateY(-50%);
            font-size: 18px;
            color: inherit; /* inherit red/green */
            pointer-events: none;
        }

        .has-feedback .form-control {
            padding-right: 40px; /* space for icon */
        }

        .has-error .form-control-feedback {
            color: #dc3545; /* red */
        }

        .has-success .form-control-feedback {
            color: #28a745; /* green */
        }

        .alert-danger {
            text-align: center; /* centers the text */
        }

            .alert-danger ul {
                list-style: none; /* remove bullets */
                padding-left: 0;
                margin-bottom: 0;
            }

                .alert-danger ul li {
                    display: inline-block; /* keep each error on its own line */
                    margin: 0 5px; /* optional spacing between errors */
                }
        .btn-success {
            padding: 10px 40px;
        }
    </style>
</head>

@using (Html.BeginForm("Login", "Account", FormMethod.Post, new { @id = "loginForm", @class = "form-horizontal", role = "form", novalidate = "novalidate" }))
{
    @Html.AntiForgeryToken()

    <div class="d-flex flex-column min-vh-100">
        <main>
            <div class="card shadow-sm border-0 p-4">
                <h3 class="text-center" style="margin-bottom: 50px; color: whitesmoke;">Login</h3>

                <div class="form-group has-feedback" style="margin-left:10px; position: relative;">
                    @Html.LabelFor(m => m.Username, new { @class = "form-label fw-semibold", style = "margin-bottom: 15px; color:whitesmoke;font-weight:500;" })
                    @Html.TextBoxFor(m => m.Username, new
                    {
                        @class = "form-control",
                        placeholder = "Enter your username",
                        required = "required",
                        style = "margin-bottom: 15px;"
                    })
                    <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                </div>

                <div class="form-group has-feedback" style="margin-left:10px; position: relative;">
                    @Html.LabelFor(m => m.Password, new { @class = "form-label fw-semibold", style = "margin-bottom: 15px;color:whitesmoke;font-weight:500;" })
                    @Html.PasswordFor(m => m.Password, new
                    {
                        @class = "form-control",
                        placeholder = "Enter your password",
                        required = "required",
                        style = "margin-bottom: 15px;"
                    })
                    <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-success" style="margin: 25px; padding: 10px; width: 250px;">Login</button>
                </div>

                <!-- Move ValidationSummary here -->
                @Html.ValidationSummary(true, "", new { @class = "alert alert-danger", style = "margin-top: 10px; list-style: none;" })
            </div>
        </main>
    </div>
}

@section scripts {
    <script type="text/javascript" src="~/Scripts/jquery-2.0.3.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery.dataTables.js"></script>
    <script type="text/javascript" src="~/Scripts/bootstrap-dataTables-paging.js"></script>
    <script type="text/javascript" src="~/Scripts/select2.js"></script>

    <script>
        $(function () {
            function validateInput($input) {
                var $parent = $input.closest('.form-group');
                var $icon = $parent.find('.form-control-feedback');

                if (!$input.val().trim()) {
                    $parent.removeClass('has-success').addClass('has-error');
                    $icon.removeClass('glyphicon-ok').addClass('glyphicon-exclamation-sign');
                    return false;
                } else {
                    $parent.removeClass('has-error').addClass('has-success');
                    $icon.removeClass('glyphicon-exclamation-sign').addClass('glyphicon-ok');
                    return true;
                }
            }

            // Live validation as the user types
            $('#loginForm input[required]').on('input', function () {
                validateInput($(this));
            });

            // Final validation on submit
            $('#loginForm').on('submit', function (e) {
                var isValid = true;
                $(this).find('input[required]').each(function () {
                    if (!validateInput($(this))) isValid = false;
                });

                if (!isValid) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            });
        });
    </script>
}